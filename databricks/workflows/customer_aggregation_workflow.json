{
  "name": "Customer_Aggregation_Parallel_Workflow",
  "email_notifications": {
    "on_failure": ["eran@seemplicity.io"],
    "on_success": ["eran@seemplicity.io"]
  },
  "timeout_seconds": 14400,
  "max_concurrent_runs": 1,
  "job_clusters": [
    {
      "job_cluster_key": "aggregation_cluster",
      "new_cluster": {
        "spark_version": "13.3.x-scala2.12",
        "node_type_id": "i3.xlarge",
        "num_workers": 4,
        "spark_conf": {
          "spark.sql.adaptive.enabled": "true",
          "spark.sql.adaptive.coalescePartitions.enabled": "true",
          "spark.databricks.delta.retentionDurationCheck.enabled": "false"
        },
        "custom_tags": {
          "project": "spark-aggregation-poc",
          "environment": "production"
        }
      }
    }
  ],
  "tasks": [
    {
      "task_key": "unilever_aggregation",
      "job_cluster_key": "aggregation_cluster",
      "notebook_task": {
        "notebook_path": "/Users/eran@seemplicity.io/spark-aggregation-poc/notebooks/dbx_notebook_parameterized.py",
        "base_parameters": {
          "customer_schema": "unilever",
          "postgres_host": "vpce-0ab78c002b187f211-1l5gyxsr.vpce-svc-0ec8249541aa206d0.eu-central-1.vpce.amazonaws.com",
          "postgres_port": "54322",
          "postgres_db": "postgres",
          "postgres_user": "postgres",
          "postgres_password": "T66AWCNJGW!!jqML"
        }
      },
      "timeout_seconds": 7200
    },
    {
      "task_key": "carlsberg_aggregation",
      "job_cluster_key": "aggregation_cluster",
      "notebook_task": {
        "notebook_path": "/Users/eran@seemplicity.io/spark-aggregation-poc/notebooks/dbx_notebook_parameterized.py",
        "base_parameters": {
          "customer_schema": "carlsberg",
          "postgres_host": "vpce-0ab78c002b187f211-1l5gyxsr.vpce-svc-0ec8249541aa206d0.eu-central-1.vpce.amazonaws.com",
          "postgres_port": "54323",
          "postgres_db": "postgres",
          "postgres_user": "postgres",
          "postgres_password": "vCo8trJkeg57Vp53"
        }
      },
      "timeout_seconds": 7200
    }
  ]
}